import{u}from"./index-v3n02KM2.js";const T=()=>{const o=u(),f=(s,i,p={})=>{const{transactions:c,getProduct:I,updateVariantInventory:n,editTransaction:e}=o,t=c.find(a=>a.id===s);if(!t)throw new Error("لم يتم العثور على العملية");if(i<=0)throw new Error("يجب أن تكون الكمية رقمًا موجبًا");const r=I(t.typeId,t.shapeId,t.variantId);if(!r)throw new Error("لم يتم العثور على المنتج");const l=t.amount,d=i-l;if(t.type==="add"){const a=r.inStock+d;if(a<0)throw new Error("لا يمكن أن يكون المخزون الناتج بالسالب");n(t.typeId,t.shapeId,t.variantId,a,r.sold)}else if(t.type==="remove"){if(d>0&&r.inStock<d)throw new Error("مخزون غير كاف لزيادة الكمية المُزالة");const a=r.inStock-d,w=r.sold+d;if(a<0||w<0)throw new Error("قيم المخزون/المبيعات الناتجة غير صالحة");n(t.typeId,t.shapeId,t.variantId,a,w)}e(s,{amount:i,...p})},h=s=>{const{transactions:i,getProduct:p,updateVariantInventory:c,deleteTransaction:I}=o,n=i.find(t=>t.id===s);if(!n)throw new Error("لم يتم العثور على العملية");const e=p(n.typeId,n.shapeId,n.variantId);if(!e)throw new Error("لم يتم العثور على المنتج");if(n.type==="add"){const t=e.inStock-n.amount;if(t<0)throw new Error("لا يمكن التراجع عن العملية: المخزون الناتج سيكون بالسالب");c(n.typeId,n.shapeId,n.variantId,t,e.sold)}else if(n.type==="remove"){const t=e.inStock+n.amount,r=Math.max(0,e.sold-n.amount);c(n.typeId,n.shapeId,n.variantId,t,r)}I(s)};return{addTransaction:o.addTransaction,editTransaction:o.editTransaction,deleteTransaction:o.deleteTransaction,getProductTransactions:o.getProductTransactions,getAllTransactions:()=>o.transactions,modifyTransaction:f,deleteTransactionWithRevert:h}},v=()=>u(o=>o.curtainTypes);export{T as a,v as u};
